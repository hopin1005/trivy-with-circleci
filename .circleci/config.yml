version: 2.1

jobs:
  build-node-image:
    docker:
      - image: cimg/node
    steps:
      - checkout  
      - setup_remote_docker  
      - run:
          name: Build Docker image
          command: 
            docker build -t node-test -f node-test/Dockerfile .
            docker image ls
          
  build:
    docker:
      - image: aquasec/trivy
    steps:
      - run:
          name: run trivy
          command: 
            sudo usermod -aG docker $user
            trivy image node-test
            
